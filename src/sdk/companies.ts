/*
 * Code generated by Speakeasy (https://speakeasyapi.dev). DO NOT EDIT.
 */

import { SDK_METADATA, SDKOptions, serverURLFromOptions } from "../lib/config";
import * as enc$ from "../lib/encodings";
import { HTTPClient } from "../lib/http";
import { ClientSDK, RequestOptions } from "../lib/sdks";
import * as errors from "../models/errors";
import * as operations from "../models/operations";

export class Companies extends ClientSDK {
  private readonly options$: SDKOptions;

  constructor(options: SDKOptions = {}) {
    super({
      client: options.httpClient || new HTTPClient(),
      baseURL: serverURLFromOptions(options),
    });

    this.options$ = options;
    void this.options$;
  }
  /**
   * Get companies
   *
   * @remarks
   * Get a single companies record
   */
  async get(
    connectionKey: string,
    { id }: { id: string },
    options?: RequestOptions
  ): Promise<operations.GetCompaniesIdResponse> {
    const input$: operations.GetCompaniesIdRequest = {
      id: id,
      xIntegrationosSecret: this.options$.client as string,
      xIntegrationosConnectionKey: connectionKey,
    };
    const headers$ = new Headers();
    headers$.set("user-agent", SDK_METADATA.userAgent);
    headers$.set("Accept", "application/json");

    const payload$ =
      operations.GetCompaniesIdRequest$.outboundSchema.parse(input$);
    const body$ = null;

    const pathParams$ = {
      id: enc$.encodeSimple("id", payload$.id, {
        explode: false,
        charEncoding: "percent",
      }),
    };

    const path$ = this.templateURLComponent("/companies/{id}")(pathParams$);

    headers$.set(
      "X-INTEGRATIONOS-CONNECTION-KEY",
      enc$.encodeSimple(
        "X-INTEGRATIONOS-CONNECTION-KEY",
        payload$["X-INTEGRATIONOS-CONNECTION-KEY"],
        { explode: false, charEncoding: "none" }
      )
    );
    headers$.set(
      "X-INTEGRATIONOS-SECRET",
      enc$.encodeSimple(
        "X-INTEGRATIONOS-SECRET",
        payload$["X-INTEGRATIONOS-SECRET"],
        {
          explode: false,
          charEncoding: "none",
        }
      )
    );

    const response = await this.fetch$(
      { method: "get", path: path$, headers: headers$, body: body$ },
      options
    );

    const responseFields$ = {
      ContentType:
        response.headers.get("content-type") ?? "application/octet-stream",
      StatusCode: response.status,
      RawResponse: response,
    };

    if (this.matchResponse(response, 200, "application/json")) {
      const responseBody = await response.json();
      const result = operations.GetCompaniesIdResponse$.inboundSchema.parse({
        ...responseFields$,
        object: responseBody,
      });
      return result;
    } else {
      const responseBody = await response.text();
      throw new errors.SDKError(
        "Unexpected API response",
        response,
        responseBody
      );
    }
  }

  /**
   * Delete companies
   *
   * @remarks
   * Delete a single companies record
   */
  async delete(
    connectionKey: string,
    { id }: { id: string },
    options?: RequestOptions
  ): Promise<operations.DeleteCompaniesIdResponse> {
    const input$: operations.DeleteCompaniesIdRequest = {
      id: id,
      xIntegrationosSecret: this.options$.client as string,
      xIntegrationosConnectionKey: connectionKey,
    };
    const headers$ = new Headers();
    headers$.set("user-agent", SDK_METADATA.userAgent);
    headers$.set("Accept", "application/json");

    const payload$ =
      operations.DeleteCompaniesIdRequest$.outboundSchema.parse(input$);
    const body$ = null;

    const pathParams$ = {
      id: enc$.encodeSimple("id", payload$.id, {
        explode: false,
        charEncoding: "percent",
      }),
    };

    const path$ = this.templateURLComponent("/companies/{id}")(pathParams$);

    headers$.set(
      "X-INTEGRATIONOS-CONNECTION-KEY",
      enc$.encodeSimple(
        "X-INTEGRATIONOS-CONNECTION-KEY",
        payload$["X-INTEGRATIONOS-CONNECTION-KEY"],
        { explode: false, charEncoding: "none" }
      )
    );
    headers$.set(
      "X-INTEGRATIONOS-SECRET",
      enc$.encodeSimple(
        "X-INTEGRATIONOS-SECRET",
        payload$["X-INTEGRATIONOS-SECRET"],
        {
          explode: false,
          charEncoding: "none",
        }
      )
    );

    const response = await this.fetch$(
      { method: "delete", path: path$, headers: headers$, body: body$ },
      options
    );

    const responseFields$ = {
      ContentType:
        response.headers.get("content-type") ?? "application/octet-stream",
      StatusCode: response.status,
      RawResponse: response,
    };

    if (this.matchResponse(response, 200, "application/json")) {
      const responseBody = await response.json();
      const result = operations.DeleteCompaniesIdResponse$.inboundSchema.parse({
        ...responseFields$,
        object: responseBody,
      });
      return result;
    } else {
      const responseBody = await response.text();
      throw new errors.SDKError(
        "Unexpected API response",
        response,
        responseBody
      );
    }
  }

  /**
   * Update companies
   *
   * @remarks
   * Update a single companies record
   */
  async update(
    connectionKey: string,
    { id }: { id: string },
    requestBody?: operations.PatchCompaniesIdRequestBody | undefined,
    options?: RequestOptions
  ): Promise<operations.PatchCompaniesIdResponse> {
    const input$: operations.PatchCompaniesIdRequest = {
      id: id,
      xIntegrationosSecret: this.options$.client as string,
      xIntegrationosConnectionKey: connectionKey,
      requestBody: requestBody,
    };
    const headers$ = new Headers();
    headers$.set("user-agent", SDK_METADATA.userAgent);
    headers$.set("Content-Type", "application/json");
    headers$.set("Accept", "application/json");

    const payload$ =
      operations.PatchCompaniesIdRequest$.outboundSchema.parse(input$);

    const body$ = enc$.encodeJSON("body", payload$.RequestBody, {
      explode: true,
    });

    const pathParams$ = {
      id: enc$.encodeSimple("id", payload$.id, {
        explode: false,
        charEncoding: "percent",
      }),
    };

    const path$ = this.templateURLComponent("/companies/{id}")(pathParams$);

    headers$.set(
      "X-INTEGRATIONOS-CONNECTION-KEY",
      enc$.encodeSimple(
        "X-INTEGRATIONOS-CONNECTION-KEY",
        payload$["X-INTEGRATIONOS-CONNECTION-KEY"],
        { explode: false, charEncoding: "none" }
      )
    );
    headers$.set(
      "X-INTEGRATIONOS-SECRET",
      enc$.encodeSimple(
        "X-INTEGRATIONOS-SECRET",
        payload$["X-INTEGRATIONOS-SECRET"],
        {
          explode: false,
          charEncoding: "none",
        }
      )
    );

    const response = await this.fetch$(
      { method: "patch", path: path$, headers: headers$, body: body$ },
      options
    );

    const responseFields$ = {
      ContentType:
        response.headers.get("content-type") ?? "application/octet-stream",
      StatusCode: response.status,
      RawResponse: response,
    };

    if (this.matchResponse(response, 200, "application/json")) {
      const responseBody = await response.json();
      const result = operations.PatchCompaniesIdResponse$.inboundSchema.parse({
        ...responseFields$,
        object: responseBody,
      });
      return result;
    } else {
      const responseBody = await response.text();
      throw new errors.SDKError(
        "Unexpected API response",
        response,
        responseBody
      );
    }
  }

  /**
   * List companies
   *
   * @remarks
   * Get all companies records
   */
  async list(
    connectionKey: string,
    options?: RequestOptions
  ): Promise<operations.GetCompaniesResponse> {
    const input$: operations.GetCompaniesRequest = {
      xIntegrationosSecret: this.options$.client as string,
      xIntegrationosConnectionKey: connectionKey,
    };
    const headers$ = new Headers();
    headers$.set("user-agent", SDK_METADATA.userAgent);
    headers$.set("Accept", "application/json");

    const payload$ =
      operations.GetCompaniesRequest$.outboundSchema.parse(input$);
    const body$ = null;

    const path$ = this.templateURLComponent("/companies")();

    headers$.set(
      "X-INTEGRATIONOS-CONNECTION-KEY",
      enc$.encodeSimple(
        "X-INTEGRATIONOS-CONNECTION-KEY",
        payload$["X-INTEGRATIONOS-CONNECTION-KEY"],
        { explode: false, charEncoding: "none" }
      )
    );
    headers$.set(
      "X-INTEGRATIONOS-SECRET",
      enc$.encodeSimple(
        "X-INTEGRATIONOS-SECRET",
        payload$["X-INTEGRATIONOS-SECRET"],
        {
          explode: false,
          charEncoding: "none",
        }
      )
    );

    const response = await this.fetch$(
      { method: "get", path: path$, headers: headers$, body: body$ },
      options
    );

    const responseFields$ = {
      ContentType:
        response.headers.get("content-type") ?? "application/octet-stream",
      StatusCode: response.status,
      RawResponse: response,
    };

    if (this.matchResponse(response, 200, "application/json")) {
      const responseBody = await response.json();
      const result = operations.GetCompaniesResponse$.inboundSchema.parse({
        ...responseFields$,
        object: responseBody,
      });
      return result;
    } else {
      const responseBody = await response.text();
      throw new errors.SDKError(
        "Unexpected API response",
        response,
        responseBody
      );
    }
  }

  /**
   * Create companies
   *
   * @remarks
   * Create a single companies record
   */
  async create(
    connectionKey: string,
    requestBody: operations.PostCompaniesRequestBody,
    options?: RequestOptions
  ): Promise<operations.PostCompaniesResponse> {
    const input$: operations.PostCompaniesRequest = {
      xIntegrationosSecret: this.options$.client as string,
      xIntegrationosConnectionKey: connectionKey,
      requestBody: requestBody,
    };
    const headers$ = new Headers();
    headers$.set("user-agent", SDK_METADATA.userAgent);
    headers$.set("Content-Type", "application/json");
    headers$.set("Accept", "application/json");

    const payload$ =
      operations.PostCompaniesRequest$.outboundSchema.parse(input$);

    const body$ = enc$.encodeJSON("body", payload$.RequestBody, {
      explode: true,
    });

    const path$ = this.templateURLComponent("/companies")();

    headers$.set(
      "X-INTEGRATIONOS-CONNECTION-KEY",
      enc$.encodeSimple(
        "X-INTEGRATIONOS-CONNECTION-KEY",
        payload$["X-INTEGRATIONOS-CONNECTION-KEY"],
        { explode: false, charEncoding: "none" }
      )
    );
    headers$.set(
      "X-INTEGRATIONOS-SECRET",
      enc$.encodeSimple(
        "X-INTEGRATIONOS-SECRET",
        payload$["X-INTEGRATIONOS-SECRET"],
        {
          explode: false,
          charEncoding: "none",
        }
      )
    );

    const response = await this.fetch$(
      { method: "post", path: path$, headers: headers$, body: body$ },
      options
    );

    const responseFields$ = {
      ContentType:
        response.headers.get("content-type") ?? "application/octet-stream",
      StatusCode: response.status,
      RawResponse: response,
    };

    if (this.matchResponse(response, 200, "application/json")) {
      const responseBody = await response.json();
      const result = operations.PostCompaniesResponse$.inboundSchema.parse({
        ...responseFields$,
        object: responseBody,
      });
      return result;
    } else {
      const responseBody = await response.text();
      throw new errors.SDKError(
        "Unexpected API response",
        response,
        responseBody
      );
    }
  }

  /**
   * Get companies count
   *
   * @remarks
   * Get the count of companies records
   */
  async count(
    connectionKey: string,
    options?: RequestOptions
  ): Promise<operations.GetCompaniesCountResponse> {
    const input$: operations.GetCompaniesCountRequest = {
      xIntegrationosSecret: this.options$.client as string,
      xIntegrationosConnectionKey: connectionKey,
    };
    const headers$ = new Headers();
    headers$.set("user-agent", SDK_METADATA.userAgent);
    headers$.set("Accept", "application/json");

    const payload$ =
      operations.GetCompaniesCountRequest$.outboundSchema.parse(input$);
    const body$ = null;

    const path$ = this.templateURLComponent("/companies/count")();

    headers$.set(
      "X-INTEGRATIONOS-CONNECTION-KEY",
      enc$.encodeSimple(
        "X-INTEGRATIONOS-CONNECTION-KEY",
        payload$["X-INTEGRATIONOS-CONNECTION-KEY"],
        { explode: false, charEncoding: "none" }
      )
    );
    headers$.set(
      "X-INTEGRATIONOS-SECRET",
      enc$.encodeSimple(
        "X-INTEGRATIONOS-SECRET",
        payload$["X-INTEGRATIONOS-SECRET"],
        {
          explode: false,
          charEncoding: "none",
        }
      )
    );

    const response = await this.fetch$(
      { method: "get", path: path$, headers: headers$, body: body$ },
      options
    );

    const responseFields$ = {
      ContentType:
        response.headers.get("content-type") ?? "application/octet-stream",
      StatusCode: response.status,
      RawResponse: response,
    };

    if (this.matchResponse(response, 200, "application/json")) {
      const responseBody = await response.json();
      const result = operations.GetCompaniesCountResponse$.inboundSchema.parse({
        ...responseFields$,
        object: responseBody,
      });
      return result;
    } else {
      const responseBody = await response.text();
      throw new errors.SDKError(
        "Unexpected API response",
        response,
        responseBody
      );
    }
  }
}
